{% extends 'layout/event_page_base.html' %}
{% from 'forms/_form.html' import form_header, form_footer, form_fieldset, form_rows %}

{% block title %}
    {%- trans %}Survey{% endtrans -%}
{% endblock %}

{% block subtitle %}
    {{ survey.title }}
    {% if event.getType() != 'conference' %}
        <small>({{ event.getTitle() }})</small>
    {% endif %}
{% endblock %}

{% block description %}
    {{ survey.introduction }}
{% endblock %}

{% block content %}
    {{ form_header(form, id='survey-form') }}
    {% for fieldset in form._sections %}
        {% call form_fieldset(fieldset.title, fieldset.description|replace('\n', '<br>'|safe), render_as_fieldset=fieldset.title is not none) %}
            {{ form_rows(form, fields=fieldset.fields) }}
        {% endcall %}
    {% endfor %}
    {% call form_footer(form) %}
        <input class="i-button big highlight" type="submit" value="{% trans %}Save answers{% endtrans %}"
               data-disabled-until-change>
        {% if back_button_endpoint is not none %}
            <a href="{{ url_for(back_button_endpoint, event) }}" class="i-button big" data-button-back>
                {%- trans %}Back{% endtrans -%}
            </a>
        {% endif %}
    {% endcall %}

    <script>
        // allow deselecting a horizontal radio button unless it's required
        $('#survey-form .inline-vcentered input:radio:not([required])').resettableRadioButtons();
    </script>
{% endblock %}
