{% extends 'events/surveys/manage_survey_base.html' %}
{% from 'events/surveys/_questionnaire.html' import render_questionnaire %}

{% block content %}
    <div class="flashed-messages"></div>

    <div class="i-box titled">
        <div class="i-box-header">
            <div class="i-box-title">
                {% trans %}Questionnaire{% endtrans %}
            </div>
            <div class="i-box-buttons toolbar right">
                <div class="group">
                    <a href="{{ url_for('.manage_survey', survey) }}" class="i-button">{% trans %}Go back{% endtrans %}</a>
                </div>
                <div class="group js-add-question-dropdown">
                    <a class="i-button arrow" data-toggle="dropdown">{% trans %}Add new question{% endtrans %}</a>
                    <ul class="dropdown">
                        {% for field_type in field_types.values() | sort(attribute='friendly_name') %}
                            <li>
                                <a href="#" data-href="{{ url_for('.add_question', survey, type=field_type.name) }}"
                                   data-title="{% trans %}Add question{% endtrans %}"
                                   class="js-question-dialog">
                                    {{ field_type.friendly_name }}
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>

        <div id="questionnaire" data-sort-url="{{ url_for('.sort_questions', survey) }}">
            {{ render_questionnaire(survey, preview_form) }}
        </div>
    </div>
    <script>
        setupQuestionSorter();
    </script>
{% endblock %}
